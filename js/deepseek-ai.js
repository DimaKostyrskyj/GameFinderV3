class GameSearchAI {
    constructor(apiKey) {
        this.apiKey = apiKey;
        this.baseURL = 'https://api.deepseek.com/v1';
    }

    async searchGames(userQuery) {
        try {
            console.log('ü§ñ Starting direct AI search for:', userQuery);
            
            const prompt = this.createSearchPrompt(userQuery);
            
            const response = await fetch('https://api.deepseek.com/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${this.apiKey}`,
                },
                body: JSON.stringify({
                    model: "deepseek-chat",
                    messages: [
                        {
                            role: "system",
                            content: "–¢—ã –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –ø–æ–¥–±–æ—Ä—É –∏–≥—Ä. –û—Ç–≤–µ—á–∞–π –¢–û–õ–¨–ö–û –≤ valid JSON —Ñ–æ—Ä–º–∞—Ç–µ."
                        },
                        {
                            role: "user", 
                            content: prompt
                        }
                    ],
                    max_tokens: 4000,
                    temperature: 0.7,
                    stream: false
                })
            });

            console.log('üì• Response status:', response.status);
            
            if (!response.ok) {
                const errorText = await response.text();
                console.error('‚ùå Direct API error:', response.status, errorText);
                
                // –ï—Å–ª–∏ CORS –æ—à–∏–±–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback
                if (response.status === 0 || errorText.includes('CORS')) {
                    return this.getFallbackResponse(userQuery);
                }
                
                throw new Error(`API Error: ${response.status}`);
            }

            const data = await response.json();
            console.log('‚úÖ AI Response received');
            
            if (!data.choices || !data.choices[0]) {
                throw new Error('Invalid response from AI');
            }

            const content = data.choices[0].message.content;
            return this.parseAIResponse(content);
            
        } catch (error) {
            console.error('‚ùå AI search error:', error);
            
            // –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º fallback –µ—Å–ª–∏ –æ—à–∏–±–∫–∞
            return this.getFallbackResponse(userQuery);
        }
    }

    getFallbackResponse(userQuery) {
        console.log('üîÑ Using fallback response for:', userQuery);
        
        // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –¥–ª—è –ª—É—á—à–µ–≥–æ fallback
        const query = userQuery.toLowerCase();
        
        let games = [];
        let analysis = {
            understoodMood: "–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ",
            recommendedStyle: "–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–≥—Ä—ã —Ä–∞–∑–Ω—ã—Ö –∂–∞–Ω—Ä–æ–≤",
            keyFactors: ["–∫–∞—á–µ—Å—Ç–≤–æ", "—Ä–µ–π—Ç–∏–Ω–≥", "–æ—Ç–∑—ã–≤—ã"],
            reasoning: "–ü–æ–¥–æ–±—Ä–∞–Ω—ã –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–≥—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞"
        };

        if (query.includes('—Ä–æ–ª–µ') || query.includes('—Ä–ø–≥') || query.includes('—Å—é–∂–µ—Ç')) {
            games = [
                {
                    name: "The Witcher 3: Wild Hunt",
                    genre: "RPG",
                    description: "–≠–ø–∏—á–µ—Å–∫–∞—è RPG —Å –±–æ–≥–∞—Ç—ã–º —Å—é–∂–µ—Ç–æ–º, –æ—Ç–∫—Ä—ã—Ç—ã–º –º–∏—Ä–æ–º –∏ —Å–ª–æ–∂–Ω—ã–º–∏ –º–æ—Ä–∞–ª—å–Ω—ã–º–∏ –≤—ã–±–æ—Ä–∞–º–∏. –ò–≥—Ä–∞ –ø–æ–ª—É—á–∏–ª–∞ –±–æ–ª–µ–µ 800 –Ω–∞–≥—Ä–∞–¥ –∫–∞–∫ –ª—É—á—à–∞—è –∏–≥—Ä–∞ –≥–æ–¥–∞.",
                    moodMatch: 0.95,
                    playtime: "100+ —á–∞—Å–æ–≤",
                    vibe: "–≠–ø–∏—á–µ—Å–∫–æ–µ —Ñ—ç–Ω—Ç–µ–∑–∏-–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ",
                    whyPerfect: "–ì–ª—É–±–æ–∫–∏–π —Å—é–∂–µ—Ç, –ø—Ä–æ—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –º–∏—Ä –∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø–æ–º–Ω—è—Ç—Å—è –Ω–∞–¥–æ–ª–≥–æ",
                    platforms: ["PC", "PS4", "XBOX", "Switch"]
                },
                {
                    name: "Cyberpunk 2077",
                    genre: "Action-RPG", 
                    description: "–ò–º–º–µ—Ä—Å–∏–≤–Ω–∞—è –∫–∏–±–µ—Ä–ø–∞–Ω–∫-–∏–≥—Ä–∞ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –º–∏—Ä–æ–º –ù–∞–π—Ç-–°–∏—Ç–∏. –ù–µ–ª–∏–Ω–µ–π–Ω—ã–π —Å—é–∂–µ—Ç —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞–∑–≤–∏—Ç–∏—è.",
                    moodMatch: 0.88,
                    playtime: "60+ —á–∞—Å–æ–≤",
                    vibe: "–§—É—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –Ω–µ–æ-–Ω—É–∞—Ä",
                    whyPerfect: "–ó–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–π –º–∏—Ä –±—É–¥—É—â–µ–≥–æ, —Å–≤–æ–±–æ–¥–∞ –¥–µ–π—Å—Ç–≤–∏–π –∏ –≤–∏–∑—É–∞–ª—å–Ω–∞—è —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è",
                    platforms: ["PC", "PS5", "XBOX Series X"]
                },
                {
                    name: "Elden Ring",
                    genre: "Action-RPG",
                    description: "–ú–∞—Å—à—Ç–∞–±–Ω–∞—è dark fantasy –∏–≥—Ä–∞ —Å –æ–≥—Ä–æ–º–Ω—ã–º –æ—Ç–∫—Ä—ã—Ç—ã–º –º–∏—Ä–æ–º. –°–ª–æ–∂–Ω—ã–µ –±–æ–∏ –∏ –≥–ª—É–±–æ–∫–∞—è –±–æ–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞.",
                    moodMatch: 0.85,
                    playtime: "80+ —á–∞—Å–æ–≤", 
                    vibe: "–°–ª–æ–∂–Ω–æ–µ —ç–ø–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ",
                    whyPerfect: "–û–≥—Ä–æ–º–Ω—ã–π –º–∏—Ä –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ –æ—Ç –ø–æ–±–µ–¥—ã –Ω–∞–¥ —Å–ª–æ–∂–Ω—ã–º–∏ –±–æ—Å—Å–∞–º–∏",
                    platforms: ["PC", "PS4", "PS5", "XBOX"]
                }
            ];
            analysis.understoodMood = "–≠–ø–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ —Å –≥–ª—É–±–æ–∫–∏–º —Å—é–∂–µ—Ç–æ–º";
            
        } else if (query.includes('—ç–∫—à–µ–Ω') || query.includes('—à—É—Ç–µ—Ä') || query.includes('—Å—Ç—Ä–µ–ª—è')) {
            games = [
                {
                    name: "DOOM Eternal",
                    genre: "–®—É—Ç–µ—Ä",
                    description: "–ë–µ–∑—É–º–Ω—ã–π —à—É—Ç–µ—Ä —Å –±—ã—Å—Ç—Ä—ã–º –≥–µ–π–º–ø–ª–µ–µ–º –∏ —ç–ø–∏—á–µ—Å–∫–∏–º–∏ —Å—Ä–∞–∂–µ–Ω–∏—è–º–∏ —Å –¥–µ–º–æ–Ω–∞–º–∏. –û–¥–Ω–∞ –∏–∑ –ª—É—á—à–∏—Ö –∏–≥—Ä –≤ –∂–∞–Ω—Ä–µ.",
                    moodMatch: 0.92,
                    playtime: "15-20 —á–∞—Å–æ–≤",
                    vibe: "–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–π –∞–¥—Ä–µ–Ω–∞–ª–∏–Ω–æ–≤—ã–π —ç–∫—à–µ–Ω",
                    whyPerfect: "–ë—ã—Å—Ç—Ä—ã–π —Ç–µ–º–ø, –º–æ—â–Ω—ã–π —Å–∞—É–Ω–¥—Ç—Ä–µ–∫ –∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏–π –≥–µ–π–º–ø–ª–µ–π",
                    platforms: ["PC", "PS4", "XBOX", "Switch"]
                },
                {
                    name: "Call of Duty: Warzone",
                    genre: "–ë–∞—Ç–ª-—Ä–æ—è–ª",
                    description: "–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –±–∞—Ç–ª-—Ä–æ—è–ª —à—É—Ç–µ—Ä —Å –º–∞—Å—à—Ç–∞–±–Ω—ã–º–∏ –±–∏—Ç–≤–∞–º–∏ –Ω–∞ 150 –∏–≥—Ä–æ–∫–æ–≤. –ü–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.",
                    moodMatch: 0.87,
                    playtime: "–ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ",
                    vibe: "–ö–æ–º–∞–Ω–¥–Ω—ã–π —Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —ç–∫—à–µ–Ω", 
                    whyPerfect: "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ, –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏ –∞–∫—Ç–∏–≤–Ω–æ–µ –∫–æ–º—å—é–Ω–∏—Ç–∏",
                    platforms: ["PC", "PS4", "PS5", "XBOX"]
                },
                {
                    name: "Grand Theft Auto V",
                    genre: "Action-adventure",
                    description: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –∏–≥—Ä–∞ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –º–∏—Ä–æ–º. –¢—Ä–∏ –ø—Ä–æ—Ç–∞–≥–æ–Ω–∏—Å—Ç–∞, –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏ GTA Online.",
                    moodMatch: 0.90,
                    playtime: "30+ —á–∞—Å–æ–≤ (—Å—é–∂–µ—Ç)",
                    vibe: "–ö—Ä–∏–º–∏–Ω–∞–ª—å–Ω–∞—è —Å–∞–≥–∞ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –º–∏—Ä–µ",
                    whyPerfect: "–ù–µ–≤–µ—Ä–æ—è—Ç–Ω–∞—è —Å–≤–æ–±–æ–¥–∞ –¥–µ–π—Å—Ç–≤–∏–π –∏ –ø—Ä–æ—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –º–∏—Ä",
                    platforms: ["PC", "PS4", "PS5", "XBOX"]
                }
            ];
            analysis.understoodMood = "–î–∏–Ω–∞–º–∏—á–Ω—ã–π –∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–π —ç–∫—à–µ–Ω";
            
        } else if (query.includes('—Ä–∞—Å—Å–ª–∞–±') || query.includes('—É—é—Ç–Ω') || query.includes('—Å–ø–æ–∫–æ–π')) {
            games = [
                {
                    name: "Stardew Valley", 
                    genre: "–§–µ—Ä–º–∞-—Å–∏–º—É–ª—è—Ç–æ—Ä",
                    description: "–†–∞—Å—Å–ª–∞–±–ª—è—é—â–∞—è –∏–≥—Ä–∞ –æ –∂–∏–∑–Ω–∏ –≤ –¥–µ—Ä–µ–≤–Ω–µ. –§–µ—Ä–º–µ—Ä—Å—Ç–≤–æ, —Ä—ã–±–∞–ª–∫–∞, –æ–±—â–µ–Ω–∏–µ —Å –∂–∏—Ç–µ–ª—è–º–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π —Ñ–µ—Ä–º—ã.",
                    moodMatch: 0.98,
                    playtime: "50+ —á–∞—Å–æ–≤",
                    vibe: "–£—é—Ç–Ω–∞—è –∏ –º–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω–∞—è",
                    whyPerfect: "–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —Ç—è–∂–µ–ª–æ–≥–æ –¥–Ω—è, –Ω–µ—Ç –¥–∞–≤–ª–µ–Ω–∏—è –∏ —Å–ø–µ—à–∫–∏",
                    platforms: ["PC", "PS4", "XBOX", "Switch", "Mobile"]
                },
                {
                    name: "Animal Crossing: New Horizons",
                    genre: "Life-simulation",
                    description: "–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –∏–¥–µ–∞–ª—å–Ω—ã–π –æ—Å—Ç—Ä–æ–≤, –ª–æ–≤–∏—Ç–µ —Ä—ã–±—É, —Å–æ–±–∏—Ä–∞–π—Ç–µ –Ω–∞—Å–µ–∫–æ–º—ã—Ö –∏ –æ–±—É—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ —Å–≤–æ–π –¥–æ–º –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å –ø—Ä–∏—Ä–æ–¥–æ–π.",
                    moodMatch: 0.95,
                    playtime: "100+ —á–∞—Å–æ–≤", 
                    vibe: "–£–º–∏—Ä–æ—Ç–≤–æ—Ä—è—é—â–∞—è –∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∞—è",
                    whyPerfect: "–ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä–µ—Å—Å–∞, —Ç–≤–æ—Ä—á–µ—Å–∫–∞—è —Å–≤–æ–±–æ–¥–∞ –∏ –æ—á–∞—Ä–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∏–ª—å",
                    platforms: ["Switch"]
                },
                {
                    name: "Journey",
                    genre: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ",
                    description: "–ü–æ—ç—Ç–∏—á–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –≤ –ø—É—Å—Ç—ã–Ω–µ. –ö—Ä–∞—Å–∏–≤–∞—è –≤–∏–∑—É–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –±–µ–∑ —Å–ª–æ–≤, —Ç–æ–ª—å–∫–æ —ç–º–æ—Ü–∏–∏ –∏ –º—É–∑—ã–∫–∞.",
                    moodMatch: 0.93,
                    playtime: "2-3 —á–∞—Å–∞",
                    vibe: "–ü–æ—ç—Ç–∏—á–Ω–æ–µ –∏ –º–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω–æ–µ",
                    whyPerfect: "–ö–æ—Ä–æ—Ç–∫–∞—è, –Ω–æ –Ω–µ–∑–∞–±—ã–≤–∞–µ–º–∞—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è, –∏–¥–µ–∞–ª—å–Ω–∞—è –¥–ª—è —Ä–µ–ª–∞–∫—Å–∞",
                    platforms: ["PC", "PS4", "PS5"]
                }
            ];
            analysis.understoodMood = "–°–ø–æ–∫–æ–π–Ω–æ–µ –∏ —Ä–∞—Å—Å–ª–∞–±–ª—è—é—â–µ–µ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ";
            
        } else {
            // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–≥—Ä—ã
            games = [
                {
                    name: "The Witcher 3: Wild Hunt",
                    genre: "RPG",
                    description: "–≠–ø–∏—á–µ—Å–∫–∞—è RPG —Å –±–æ–≥–∞—Ç—ã–º —Å—é–∂–µ—Ç–æ–º –∏ –æ—Ç–∫—Ä—ã—Ç—ã–º –º–∏—Ä–æ–º. –ë–æ–ª–µ–µ 800 –Ω–∞–≥—Ä–∞–¥ –∏ –∑–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π –∏–∑ –ª—É—á—à–∏—Ö –∏–≥—Ä –≤ –∏—Å—Ç–æ—Ä–∏–∏.",
                    moodMatch: 0.90,
                    playtime: "100+ —á–∞—Å–æ–≤",
                    vibe: "–≠–ø–∏—á–µ—Å–∫–æ–µ —Ñ—ç–Ω—Ç–µ–∑–∏",
                    whyPerfect: "–ù–µ–≤–µ—Ä–æ—è—Ç–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ —Å—é–∂–µ—Ç–∞ –∏ –º–∏—Ä–∞, –∑–∞ –∫–æ—Ç–æ—Ä—É—é –∏–≥—Ä–∞ –ø–æ–ª—É—á–∏–ª–∞ –≤—Å–µ–º–∏—Ä–Ω–æ–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ",
                    platforms: ["PC", "PS4", "XBOX", "Switch"]
                },
                {
                    name: "Red Dead Redemption 2",
                    genre: "Action-adventure",
                    description: "–≠–ø–∏—á–µ—Å–∫–∞—è –∏—Å—Ç–æ—Ä–∏—è –æ –¥–∏–∫–æ–º –∑–∞–ø–∞–¥–µ —Å –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –º–∏—Ä–∞. –ñ–∏–∑–Ω—å –∫–æ–≤–±–æ—è –ê—Ä—Ç—É—Ä–∞ –ú–æ—Ä–≥–∞–Ω–∞.",
                    moodMatch: 0.88,
                    playtime: "60+ —á–∞—Å–æ–≤",
                    vibe: "–ö–æ–≤–±–æ–π—Å–∫–∞—è –¥—Ä–∞–º–∞",
                    whyPerfect: "–ö–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–Ω—ã–π —Å—é–∂–µ—Ç –∏ –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–≤—ã—Ö –º–∏—Ä–æ–≤",
                    platforms: ["PC", "PS4", "XBOX"]
                },
                {
                    name: "Baldur's Gate 3",
                    genre: "RPG",
                    description: "–ì–ª—É–±–æ–∫–∞—è RPG –Ω–∞ –æ—Å–Ω–æ–≤–µ D&D —Å –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–π —Å–≤–æ–±–æ–¥–æ–π –≤—ã–±–æ—Ä–∞. –ö–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏—Å—Ç–æ—Ä–∏—é.",
                    moodMatch: 0.92,
                    playtime: "80+ —á–∞—Å–æ–≤",
                    vibe: "–¢–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ñ—ç–Ω—Ç–µ–∑–∏-–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ", 
                    whyPerfect: "–ë–µ—Å–ø—Ä–µ—Ü–µ–¥–µ–Ω—Ç–Ω–∞—è —Å–≤–æ–±–æ–¥–∞ –¥–µ–π—Å—Ç–≤–∏–π –∏ –≥–ª—É–±–∏–Ω–∞ –∏–≥—Ä–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞",
                    platforms: ["PC", "PS5", "XBOX Series X"]
                },
                {
                    name: "Elden Ring",
                    genre: "Action-RPG",
                    description: "–ù–æ–≤–∞—Ç–æ—Ä—Å–∫–∞—è –∏–≥—Ä–∞ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –º–∏—Ä–æ–º –æ—Ç —Å–æ–∑–¥–∞—Ç–µ–ª–µ–π Dark Souls. –ò—Å—Å–ª–µ–¥—É–π—Ç–µ –ó–µ–º–ª–∏ –ú–µ–∂–¥—É–∑–µ–º–∏—è.",
                    moodMatch: 0.85,
                    playtime: "80+ —á–∞—Å–æ–≤",
                    vibe: "–°–ª–æ–∂–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ",
                    whyPerfect: "–ì–µ–Ω–∏–∞–ª—å–Ω–æ–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –º–∏—Ä–∞ –∏ —Å–ª–æ–∂–Ω–æ–≥–æ –≥–µ–π–º–ø–ª–µ—è –æ—Ç FromSoftware",
                    platforms: ["PC", "PS4", "PS5", "XBOX"]
                }
            ];
        }

        return {
            analysis: analysis,
            games: games
        };
    }

    createSearchPrompt(userQuery) {
        return `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—â–µ—Ç –∏–≥—Ä—ã –ø–æ –∑–∞–ø—Ä–æ—Å—É: "${userQuery}".

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∑–∞–ø—Ä–æ—Å –∏ –ø—Ä–µ–¥–ª–æ–∂–∏ 3-4 —Å–∞–º—ã–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –∏–≥—Ä—ã. 

–í–µ—Ä–Ω–∏ –æ—Ç–≤–µ—Ç –¢–û–õ–¨–ö–û –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤:

{
    "analysis": {
        "understoodMood": "—Å—Ç—Ä–æ–∫–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è",
        "recommendedStyle": "—Å—Ç—Ä–æ–∫–∞ —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º —Å—Ç–∏–ª–µ–º", 
        "keyFactors": ["—Ñ–∞–∫—Ç–æ—Ä1", "—Ñ–∞–∫—Ç–æ—Ä2", "—Ñ–∞–∫—Ç–æ—Ä3"],
        "reasoning": "—Å—Ç—Ä–æ–∫–∞ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –ø–æ–¥–±–æ—Ä–∞"
    },
    "games": [
        {
            "name": "–Ω–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã",
            "genre": "–∂–∞–Ω—Ä",
            "description": "–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä—ã 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è",
            "moodMatch": 0.95,
            "playtime": "–≤—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è",
            "vibe": "–∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∏–≥—Ä—ã", 
            "whyPerfect": "–ø–æ—á–µ–º—É –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ –∑–∞–ø—Ä–æ—Å",
            "platforms": ["PC", "PS5", "XBOX", "Switch"]
        }
    ]
}`;
    }

    parseAIResponse(content) {
        try {
            // –û—á–∏—â–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç –≤–æ–∑–º–æ–∂–Ω—ã—Ö markdown —Å–∏–º–≤–æ–ª–æ–≤
            const cleanContent = content.replace(/```json|```/g, '').trim();
            return JSON.parse(cleanContent);
        } catch (error) {
            console.error('Failed to parse AI response:', error);
            console.log('Raw content:', content);
            throw new Error('Failed to parse AI response');
        }
    }
}